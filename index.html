<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Own-n-Drive — Full Ready (GAD CAPITAL)</title>
  <link rel="icon" href="assets/favicon.png" />
  <meta name="description" content="Own-n-Drive — fractional car ownership platform. Demo with optional Firebase Auth, Firestore & Storage integration." />
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Minor custom styles */
    body { font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; background: linear-gradient(180deg,#f7fbff 0%, #fff 100%); color:#0b1220; -webkit-font-smoothing:antialiased; }
    .glass { background: rgba(255,255,255,0.78); border:1px solid rgba(10,25,48,0.06); backdrop-filter: blur(6px); }
    .card-hover:hover{ transform: translateY(-8px); transition: transform .28s ease; box-shadow: 0 24px 48px rgba(10,25,48,0.08); }
    .modal-backdrop{ background: rgba(2,6,23,0.6); backdrop-filter: blur(3px); }
    .soft-shadow{ box-shadow: 0 12px 40px rgba(10,25,48,0.08); }
    @media (max-width:760px) { .desktop-only{ display:none } }
  </style>
</head>
<body class="antialiased">

  <!-- HEADER -->
  <header class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
    <div class="flex items-center gap-4">
      <img src="assets/logo.png" alt="Own-n-Drive" class="h-12" onerror="this.style.display='none'"/>
      <div>
        <div class="text-lg font-extrabold">Own-n-Drive</div>
        <div class="text-xs text-gray-500">by GAD CAPITAL</div>
      </div>
    </div>

    <div class="flex items-center gap-3">
      <nav class="hidden md:flex gap-6 text-sm text-gray-700">
        <a href="#cars" class="hover:text-navy">Vehicles</a>
        <a href="#pricing" class="hover:text-navy">Pricing</a>
        <a href="#contact" class="hover:text-navy">Contact</a>
      </nav>

      <div id="authControls" class="flex items-center gap-3">
        <button id="btnLogin" class="px-4 py-2 rounded-lg border">Login</button>
        <button id="btnSignup" class="px-4 py-2 rounded-lg bg-navy text-white">Sign up</button>
      </div>

      <div id="userControls" class="hidden items-center gap-3">
        <span id="headerUserName" class="text-sm font-semibold"></span>
        <button id="btnOpenDashboard" class="px-3 py-2 rounded-lg border">Dashboard</button>
        <button id="btnLogout" class="px-3 py-2 rounded-lg">Logout</button>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section class="max-w-7xl mx-auto px-6 grid md:grid-cols-2 gap-8 items-center py-12 relative">
    <div>
      <span class="inline-block bg-yellow-400 text-navy px-3 py-1 rounded-full font-bold text-sm">Premium • Fractional Ownership</span>
      <h1 class="mt-4 text-4xl md:text-5xl font-extrabold leading-tight">Own the Car — Split the Cost — Drive Premium</h1>
      <p class="mt-4 text-gray-600 max-w-lg">Form a group, create an SPV, split equity and enjoy a managed ownership experience — insurance, maintenance, scheduling and resale handled by GAD CAPITAL.</p>

      <div class="mt-6 flex gap-3">
        <button id="ctaBrowse" class="px-6 py-3 rounded-lg bg-navy text-white font-bold shadow">Browse Vehicles</button>
        <button id="ctaPricing" class="px-6 py-3 rounded-lg border">View Pricing</button>
      </div>
    </div>

    <div class="glass p-6 rounded-3xl soft-shadow">
      <!-- Animated car SVG (decorative) -->
      <svg viewBox="0 0 900 420" class="w-full" xmlns="http://www.w3.org/2000/svg" aria-hidden>
        <defs>
          <linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#FFC818"/><stop offset="1" stop-color="#FF9A08"/></linearGradient>
          <linearGradient id="g2" x1="0" x2="1"><stop offset="0" stop-color="#0A1930"/><stop offset="1" stop-color="#122b54"/></linearGradient>
        </defs>
        <ellipse cx="450" cy="360" rx="260" ry="28" fill="rgba(10,25,48,0.06)" />
        <g transform="translate(60,60)">
          <g style="animation: transform 4s ease-in-out infinite;">
            <rect x="60" y="90" rx="32" ry="32" width="680" height="120" fill="url(#g2)" opacity="0.95"/>
            <path d="M0 110 Q60 40 180 40 L640 40 Q760 40 820 110 L820 170 Q760 210 640 210 L180 210 Q60 210 0 170Z" fill="url(#g1)" opacity="0.14"/>
          </g>
        </g>
      </svg>

      <div class="mt-6 grid grid-cols-2 gap-3">
        <div class="p-3 bg-white rounded-lg text-center">
          <div class="text-xs text-gray-500">Equity</div><div class="font-bold">20%</div>
        </div>
        <div class="p-3 bg-white rounded-lg text-center">
          <div class="text-xs text-gray-500">Group Size</div><div class="font-bold">5 members</div>
        </div>
      </div>
    </div>
  </section>

  <!-- MAIN -->
  <main class="max-w-7xl mx-auto px-6">
    <!-- Vehicles -->
    <section id="cars" class="py-8">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">Vehicles — Telangana On-Road</h2>
        <div class="text-sm text-gray-500">Admin can manage vehicles from Dashboard</div>
      </div>
      <div id="vehicleGrid" class="grid md:grid-cols-3 gap-6"></div>
    </section>

    <!-- Pricing -->
    <section id="pricing" class="py-8">
      <h3 class="text-2xl font-bold mb-4">Telangana — On-Road Pricing (5Y maintenance incl.)</h3>
      <div class="overflow-x-auto glass rounded-lg p-4">
        <table class="w-full text-left">
          <thead><tr class="text-sm text-gray-500"><th>#</th><th>Model</th><th>On-Road (₹)</th><th>5Y Maint (₹)</th><th>Total (₹)</th><th>Per Member (₹)</th></tr></thead>
          <tbody id="pricingTable" class="text-sm text-gray-700"></tbody>
        </table>
      </div>
    </section>

    <!-- Contact -->
    <section id="contact" class="py-8">
      <div class="glass p-6 rounded-2xl">
        <h3 class="text-xl font-bold mb-3">Request a callback</h3>
        <form id="leadForm" class="grid gap-3 md:grid-cols-2">
          <input name="name" placeholder="Full name" class="p-3 border rounded" required />
          <input name="phone" placeholder="Phone" class="p-3 border rounded" required />
          <input name="email" placeholder="Email (optional)" class="p-3 border rounded" />
          <select name="model" class="p-3 border rounded">
            <option value="">Model of interest (optional)</option>
            <option>Maruti Alto K10</option><option>Kia Sonet</option><option>Tata Nexon</option><option>Hyundai i20</option>
          </select>
          <div class="md:col-span-2 flex gap-3">
            <button type="submit" class="px-4 py-3 rounded-lg bg-navy text-white">Submit</button>
            <button type="button" id="downloadLeadsCSV" class="px-4 py-3 rounded-lg border">Download CSV</button>
          </div>
          <div id="leadMsg" class="md:col-span-2 text-green-600 font-semibold"></div>
        </form>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="max-w-7xl mx-auto px-6 py-8 text-sm text-gray-600">
    <div class="flex items-center justify-between">
      <div>© <span id="year"></span> GAD CAPITAL — Own-n-Drive</div>
      <div class="flex gap-4">
        <a href="#" id="adminLink">Admin</a>
        <a href="#" id="devLink">Dev</a>
      </div>
    </div>
  </footer>

  <!-- Modal root & dashboard shell -->
  <div id="modalRoot"></div>

  <div id="dashboard" class="fixed inset-0 z-50 hidden">
    <div class="modal-backdrop absolute inset-0"></div>
    <div class="relative max-w-6xl mx-auto p-6">
      <div class="bg-white rounded-2xl shadow-lg overflow-hidden grid md:grid-cols-4" style="min-height:70vh">
        <aside class="p-6 border-r">
          <div class="flex items-center gap-3 mb-6">
            <img src="assets/logo.png" class="h-10" onerror="this.style.display='none'"/>
            <div>
              <div id="sideName" class="font-bold"></div>
              <div id="sideRole" class="text-xs text-gray-500"></div>
            </div>
          </div>
          <nav class="space-y-2">
            <button class="w-full text-left px-3 py-2 rounded-md hover:bg-gray-50 dash-tab" data-tab="overview">Overview</button>
            <button class="w-full text-left px-3 py-2 rounded-md hover:bg-gray-50 dash-tab" data-tab="leads">Leads</button>
            <button class="w-full text-left px-3 py-2 rounded-md hover:bg-gray-50 dash-tab" data-tab="vehicles">Vehicles</button>
            <button class="w-full text-left px-3 py-2 rounded-md hover:bg-gray-50 dash-tab" data-tab="updates">Daily Updates</button>
            <button id="devTab" class="w-full text-left px-3 py-2 rounded-md hover:bg-gray-50 dash-tab hidden" data-tab="dev">Developer</button>
            <div class="mt-6">
              <button id="closeDashboard" class="w-full px-3 py-2 rounded-md bg-navy text-white">Close</button>
              <button id="logoutDashboard" class="w-full mt-2 px-3 py-2 rounded-md border">Logout</button>
            </div>
          </nav>
        </aside>
        <main id="dashContent" class="md:col-span-3 p-6 overflow-auto"></main>
      </div>
    </div>
  </div>

  <!-- FIREBASE + APP LOGIC -->
  <script type="module">
    /* =========================
       Firebase-ready front-end
       - Paste your firebaseConfig below to enable live mode
       - If firebaseConfig remains null => localStorage demo mode runs
       ========================= */

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, collection, addDoc, getDocs, doc, setDoc, updateDoc, deleteDoc, query, where } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { getStorage, ref as sref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

    // ---------- PASTE FIREBASE CONFIG OBJECT HERE ----------
    // Example:
    // const firebaseConfig = {
    //   apiKey: "YOUR_KEY",
    //   authDomain: "YOUR_PROJECT.firebaseapp.com",
    //   projectId: "YOUR_PROJECT",
    //   storageBucket: "YOUR_PROJECT.appspot.com",
    //   messagingSenderId: "SENDER_ID",
    //   appId: "APP_ID"
    // };
    const firebaseConfig = null; // <-- replace null with your config to enable Firebase

    // ---------- Init ----------
    let demoLocal = true;
    let app, auth, db, storage;
    if (firebaseConfig) {
      try {
        app = initializeApp(firebaseConfig);
        auth = getAuth(app);
        db = getFirestore(app);
        storage = getStorage(app);
        demoLocal = false;
        console.log("Firebase initialized — live mode");
      } catch (err) {
        console.error("Firebase initialization failed — falling back to local demo:", err);
        demoLocal = true;
      }
    } else {
      console.log("No Firebase config — running in local demo mode.");
    }

    // ---------- Utilities ----------
    const uid = () => 'u_' + Math.random().toString(36).slice(2,9);
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from((ctx||document).querySelectorAll(sel));

    // ---------- Local demo seeds ----------
    function seedLocal() {
      if (!localStorage.getItem('od_users')) {
        const admin = { id: uid(), name: 'Admin', email: 'admin@ownndrive.com', password: 'admin123', role: 'admin' };
        const dev = { id: uid(), name: 'Dev', email: 'dev@ownndrive.com', password: 'dev123', role: 'dev' };
        const user = { id: uid(), name: 'Test User', email: 'user@ownndrive.com', password: 'user123', role: 'user' };
        localStorage.setItem('od_users', JSON.stringify([admin, dev, user]));
      }
      if (!localStorage.getItem('od_vehicles')) {
        const vehicles = [
{ id:1, model:"Maruti Alto K10", onRoad:"5,42,640", maint:"65,000", total:"6,07,640", perMember:"1,51,910", image:"assets/alto.png" },
{ id:2, model:"Renault Kwid", onRoad:"5,37,840", maint:"65,000", total:"6,02,840", perMember:"1,50,710", image:"assets/kwid.png" },
{ id:3, model:"Maruti S-Presso", onRoad:"4,79,360", maint:"65,000", total:"5,44,360", perMember:"1,36,090", image:"assets/spresso.png" },
{ id:4, model:"Tata Tiago", onRoad:"7,67,200", maint:"65,000", total:"8,32,200", perMember:"2,08,050", image:"assets/tiago.png" },
{ id:5, model:"Hyundai Grand i10 Nios", onRoad:"7,15,150", maint:"65,000", total:"7,80,150", perMember:"1,95,038", image:"assets/nios.png" },
{ id:6, model:"Maruti Swift", onRoad:"8,20,630", maint:"65,000", total:"8,85,630", perMember:"2,21,408", image:"assets/swift.png" },
{ id:7, model:"Maruti Baleno", onRoad:"9,05,570", maint:"65,000", total:"9,70,570", perMember:"2,42,643", image:"assets/baleno.png" },
{ id:8, model:"Tata Punch", onRoad:"8,22,000", maint:"65,000", total:"8,87,000", perMember:"2,21,750", image:"assets/punch.png" },
{ id:9, model:"Kia Sonet", onRoad:"11,94,630", maint:"65,000", total:"12,59,630", perMember:"3,14,908", image:"assets/sonet.png" },
{ id:10, model:"Tata Nexon", onRoad:"12,33,000", maint:"65,000", total:"12,98,000", perMember:"3,24,500", image:"assets/nexon.png" },
{ id:11, model:"Hyundai i20", onRoad:"10,27,500", maint:"65,000", total:"10,92,500", perMember:"2,73,125", image:"assets/i20.png" }
        ];
        localStorage.setItem('od_vehicles', JSON.stringify(vehicles));
      }
      if (!localStorage.getItem('od_leads')) {
        const leads = [ { id: uid(), name: "Rahul K", phone: "9876543210", model: "Kia Seltos", status: "new", created: Date.now() } ];
        localStorage.setItem('od_leads', JSON.stringify(leads));
      }
      if (!localStorage.getItem('od_updates')) {
        const updates = [ { id: uid(), title: "Fleet update: 5 new Nexons", image: '', text: "Added 5 Nexons in Hyderabad", date: Date.now() } ];
        localStorage.setItem('od_updates', JSON.stringify(updates));
      }
    }
    if (demoLocal) seedLocal();

    // ---------- Data access layer: Firestore or local ----------
    async function fetchVehicles() {
      if (!demoLocal) {
        const snap = await getDocs(collection(db, 'vehicles'));
        return snap.docs.map(d => ({ id: d.id, ...d.data() }));
      } else {
        return JSON.parse(localStorage.getItem('od_vehicles') || '[]');
      }
    }
    async function addVehicle(v) {
      if (!demoLocal) {
        const ref = await addDoc(collection(db, 'vehicles'), v); return { id: ref.id, ...v };
      } else {
        const vs = JSON.parse(localStorage.getItem('od_vehicles')||'[]'); v.id = Date.now(); vs.push(v); localStorage.setItem('od_vehicles', JSON.stringify(vs)); return v;
      }
    }
    async function updateVehicle(id, patch) {
      if (!demoLocal) {
        await updateDoc(doc(db, 'vehicles', id), patch);
      } else {
        let vs = JSON.parse(localStorage.getItem('od_vehicles')||'[]'); vs = vs.map(x => x.id == id ? {...x, ...patch} : x); localStorage.setItem('od_vehicles', JSON.stringify(vs));
      }
    }
    async function deleteVehicle(id) {
      if (!demoLocal) await deleteDoc(doc(db, 'vehicles', id));
      else { let vs = JSON.parse(localStorage.getItem('od_vehicles')||'[]'); vs = vs.filter(x => x.id != id); localStorage.setItem('od_vehicles', JSON.stringify(vs)); }
    }

    async function fetchLeads() {
      if (!demoLocal) {
        const snap = await getDocs(collection(db, 'leads')); return snap.docs.map(d=>({ id: d.id, ...d.data() })).sort((a,b)=>b.created-a.created);
      } else return JSON.parse(localStorage.getItem('od_leads')||'[]');
    }
    async function addLead(lead) {
      if (!demoLocal) {
        const ref = await addDoc(collection(db, 'leads'), lead); return { id: ref.id, ...lead };
      } else {
        const leads = JSON.parse(localStorage.getItem('od_leads')||'[]'); lead.id = uid(); lead.created = Date.now(); leads.push(lead); localStorage.setItem('od_leads', JSON.stringify(leads)); return lead;
      }
    }

    async function fetchUpdates() {
      if (!demoLocal) {
        const snap = await getDocs(collection(db, 'updates')); return snap.docs.map(d=>({ id:d.id, ...d.data() })).sort((a,b)=>b.date-a.date);
      } else return JSON.parse(localStorage.getItem('od_updates')||'[]');
    }
    async function addUpdate(u) {
      if (!demoLocal) {
        const ref = await addDoc(collection(db, 'updates'), u); return { id: ref.id, ...u };
      } else {
        const ups = JSON.parse(localStorage.getItem('od_updates')||'[]'); u.id = uid(); u.date = Date.now(); ups.unshift(u); localStorage.setItem('od_updates', JSON.stringify(ups)); return u;
      }
    }

    // ---------- Storage helper ----------
    async function uploadImageToStorage(file, prefix='uploads') {
      if (!demoLocal) {
        const path = `${prefix}/${Date.now()}_${file.name.replace(/\s/g,'_')}`;
        const r = sref(storage, path);
        await uploadBytes(r, file);
        return await getDownloadURL(r);
      } else {
        // local demo -> data URL
        return await new Promise((res, rej) => { const fr = new FileReader(); fr.onload = () => res(fr.result); fr.onerror = rej; fr.readAsDataURL(file); });
      }
    }

    // ---------- Auth (local or Firebase) ----------
    let currentUser = demoLocal ? JSON.parse(localStorage.getItem('od_currentUser') || 'null') : null;

    async function signIn(email, password) {
      if (!demoLocal) {
        const cred = await signInWithEmailAndPassword(auth, email, password);
        // get user role from users collection
        const q = query(collection(db, 'users'), where('email', '==', email));
        const snap = await getDocs(q);
        if (!snap.empty) { currentUser = { id: snap.docs[0].id, ...snap.docs[0].data() }; }
        else currentUser = { id: cred.user.uid, email: cred.user.email, name: cred.user.email.split('@')[0], role: 'user' };
        return currentUser;
      } else {
        const users = JSON.parse(localStorage.getItem('od_users')||'[]');
        const u = users.find(x => x.email === email && x.password === password);
        if (!u) throw new Error('Invalid credentials');
        currentUser = u; localStorage.setItem('od_currentUser', JSON.stringify(u)); return u;
      }
    }

    async function signUp(name, email, password, role='user') {
      if (!demoLocal) {
        const cred = await createUserWithEmailAndPassword(auth, email, password);
        // store user doc with role
        await setDoc(doc(db, 'users', cred.user.uid), { name, email, role });
        currentUser = { id: cred.user.uid, name, email, role }; return currentUser;
      } else {
        const users = JSON.parse(localStorage.getItem('od_users')||'[]');
        if (users.find(x => x.email === email)) throw new Error('Email exists');
        const nu = { id: uid(), name, email, password, role }; users.push(nu); localStorage.setItem('od_users', JSON.stringify(users)); return nu;
      }
    }

    async function doSignOut() {
      if (!demoLocal) await signOut(auth);
      currentUser = null; localStorage.removeItem('od_currentUser'); updateAuthUI();
    }

    // ---------- UI rendering ----------
    async function renderVehicleGrid() {
      const grid = $('#vehicleGrid'); grid.innerHTML = '';
      const vehicles = await fetchVehicles();
      vehicles.forEach(v => {
        const card = document.createElement('article'); card.className = 'glass rounded-2xl p-5 card-hover';
        card.innerHTML = `
          <div class="relative">
            <img src="${v.image || 'assets/placeholder-car.png'}" onerror="this.src='assets/placeholder-car.png'" class="w-full h-44 object-contain rounded-lg" alt="${v.model}" />
            <div class="absolute top-4 left-4 bg-white/80 px-3 py-1 rounded-full text-xs font-semibold">Share 1/5</div>
          </div>
          <div class="mt-4 flex items-center justify-between">
           
